import{g as j}from"./source-C6q21X3i.js";import{d as B,db as L,r as V,v as M,a as r,c as v,o as c,b as o,u as l,w as n,F as R,y as h,f as P,h as x,t as T}from"./index-DsliLC_t.js";const G=B({__name:"elastic-property",props:{nodeData:Object,lf:Object||String,flowDetail:{type:Object,default:()=>({})},type:{type:String}},setup(d,{expose:g,emit:C}){const m=d,p=C;let t=L({name:"Elastic数据写入",description:"",datasourceCode:null,datasourceName:"",index:null,primaryKey:[]});const k={name:[{required:!0,message:"名称必填"}],datasourceCode:[{required:!0}],index:[{required:!0}],primaryKey:[{required:!0}]},D=()=>{m.lf.setProperties(m.nodeData.id,{...t})},E=s=>{s.validateResult===!0&&(D(),p("closed"))},y=V(null);function F(){y.value.submit()}const f=()=>{p("closed")};function b(s){t.datasourceName=s.name}const _=V([]);async function S(){await j({query:{type:"Elastic",status:"ENABLE"},page:{current:1,size:9999},orders:[]}).then(s=>{const{records:e}=s;_.value=e,e.forEach(u=>{if(m.nodeData.properties.datasourceCode===u.code){b(u);return}})}),Object.assign(t,m.nodeData.properties)}return M(()=>{S()}),g({cancelFunc:f,clickFormSubmit:F}),(s,e)=>{const u=r("t-input"),i=r("t-form-item"),w=r("t-option"),U=r("t-select"),q=r("t-tag-input"),K=r("t-divider"),N=r("t-textarea"),O=r("t-form");return c(),v("div",null,[o(O,{ref_key:"form",ref:y,rules:k,data:l(t),colon:!0,onReset:f,onSubmit:E},{default:n(()=>[o(i,{label:"名称",name:"name"},{default:n(()=>[o(u,{modelValue:l(t).name,"onUpdate:modelValue":e[0]||(e[0]=a=>l(t).name=a),readonly:d.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1}),o(i,{label:"数据源",name:"datasourceCode"},{default:n(()=>[o(U,{filterable:"",readonly:d.type==="publish",modelValue:l(t).datasourceCode,"onUpdate:modelValue":e[1]||(e[1]=a=>l(t).datasourceCode=a),placeholder:"请选择数据源",style:{width:"100%"}},{default:n(()=>[(c(!0),v(R,null,h(_.value,a=>(c(),P(w,{value:a.code,onClick:$=>b(a),label:a.name},{default:n(()=>[x(T(a.name),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["readonly","modelValue"])]),_:1}),o(i,{label:"索引名称",name:"index"},{default:n(()=>[o(u,{modelValue:l(t).index,"onUpdate:modelValue":e[2]||(e[2]=a=>l(t).index=a),readonly:d.type==="publish",placeholder:"例如：order_${createTime.format('yyyyMM')}"},null,8,["modelValue","readonly"])]),_:1}),o(i,{label:"主键列",name:"primaryKey"},{default:n(()=>[o(q,{modelValue:l(t).primaryKey,"onUpdate:modelValue":e[3]||(e[3]=a=>l(t).primaryKey=a),readonly:d.type==="publish","excess-tags-display-type":"break-line",placeholder:"请输入主键列，回车确认",clearable:""},null,8,["modelValue","readonly"])]),_:1}),o(K,null,{default:n(()=>[...e[5]||(e[5]=[x("其他配置",-1)])]),_:1}),o(i,{label:"描述",prop:"description"},{default:n(()=>[o(N,{modelValue:l(t).description,"onUpdate:modelValue":e[4]||(e[4]=a=>l(t).description=a),readonly:d.type==="publish",rows:4},null,8,["modelValue","readonly"])]),_:1})]),_:1},8,["data"])])}}});export{G as _};

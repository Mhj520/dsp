import{l as T,g as $}from"./source-C6q21X3i.js";import{d as z,db as A,r as p,v as G,a as u,c as y,o as i,b as o,u as a,w as n,f,x as H,F as D,y as S,h as b,t as N}from"./index-DsliLC_t.js";const Q=z({__name:"mongodb-property",props:{nodeData:Object,lf:Object||String,flowDetail:{type:Object,default:()=>({})},type:{type:String}},setup(d,{expose:w,emit:F}){const c=d,_=F;let l=A({name:"MongoDB数据写入",description:"",datasourceCode:null,datasourceName:"",collection:null,schemaCode:null,schemaName:null,primaryKey:["_id"]});const U={name:[{required:!0,message:"名称必填"}],datasourceCode:[{required:!0}],collection:[{required:!0}],primaryKey:[{required:!0}],schemaCode:[{required:!0,message:"数据库必选"}]},q=()=>{c.lf.setProperties(c.nodeData.id,{...l})},B=r=>{r.validateResult===!0&&(q(),_("closed"))},V=p(null);function E(){V.value.submit()}const C=()=>{_("closed")},v=p([]),g=p([]);function h(r){l.datasourceName=r.name,T({id:r.id}).then(t=>{t&&(g.value=t)})}function K(r){l.schemaName=r.label}async function O(){await $({query:{type:"MongoDB",status:"ENABLE"},page:{current:1,size:9999},orders:[]}).then(r=>{if(r){const{records:t}=r;v.value=t,t.forEach(m=>{if(c.nodeData.properties.datasourceCode===m.code){h(m);return}})}}),Object.assign(l,c.nodeData.properties)}return G(()=>{O()}),w({cancelFunc:C,clickFormSubmit:E}),(r,t)=>{const m=u("t-input"),s=u("t-form-item"),k=u("t-option"),x=u("t-select"),j=u("t-tag-input"),L=u("t-divider"),M=u("t-textarea"),R=u("t-form");return i(),y("div",null,[o(R,{ref_key:"form",ref:V,rules:U,data:a(l),colon:!0,onReset:C,onSubmit:B},{default:n(()=>[o(s,{label:"名称",name:"name"},{default:n(()=>[o(m,{modelValue:a(l).name,"onUpdate:modelValue":t[0]||(t[0]=e=>a(l).name=e),readonly:d.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1}),o(s,{label:"数据源",name:"datasourceCode"},{default:n(()=>[o(x,{filterable:"",readonly:d.type==="publish",modelValue:a(l).datasourceCode,"onUpdate:modelValue":t[1]||(t[1]=e=>a(l).datasourceCode=e),placeholder:"请选择数据源",style:{width:"100%"}},{default:n(()=>[(i(!0),y(D,null,S(v.value,e=>(i(),f(k,{value:e.code,onClick:P=>h(e),label:e.name},{default:n(()=>[b(N(e.name),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["readonly","modelValue"])]),_:1}),a(l).datasourceCode?(i(),f(s,{key:0,label:"库",name:"schemaCode"},{default:n(()=>[o(x,{modelValue:a(l).schemaCode,"onUpdate:modelValue":t[2]||(t[2]=e=>a(l).schemaCode=e),readonly:d.type==="publish",placeholder:"请选择数据库",style:{width:"100%"}},{default:n(()=>[(i(!0),y(D,null,S(g.value,e=>(i(),f(k,{value:e.key,onClick:P=>K(e),label:e.label},{default:n(()=>[b(N(e.label),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["modelValue","readonly"])]),_:1})):H("",!0),o(s,{label:"集合",name:"collection"},{default:n(()=>[o(m,{modelValue:a(l).collection,"onUpdate:modelValue":t[3]||(t[3]=e=>a(l).collection=e),readonly:d.type==="publish",placeholder:"请输入集合名称"},null,8,["modelValue","readonly"])]),_:1}),o(s,{label:"主键列",name:"primaryKey"},{default:n(()=>[o(j,{modelValue:a(l).primaryKey,"onUpdate:modelValue":t[4]||(t[4]=e=>a(l).primaryKey=e),readonly:d.type==="publish","excess-tags-display-type":"break-line",placeholder:"请输入主键列，回车确认",clearable:""},null,8,["modelValue","readonly"])]),_:1}),o(L,null,{default:n(()=>[...t[6]||(t[6]=[b("其他配置",-1)])]),_:1}),o(s,{label:"描述",prop:"description"},{default:n(()=>[o(M,{modelValue:a(l).description,"onUpdate:modelValue":t[5]||(t[5]=e=>a(l).description=e),readonly:d.type==="publish",rows:4},null,8,["modelValue","readonly"])]),_:1})]),_:1},8,["data"])])}}});export{Q as _};

import{l as z,g as A}from"./source-C6q21X3i.js";import{d as G,db as H,r as b,v as I,a as d,c as f,o as u,b as r,u as l,w as o,f as p,x as U,F as h,y as _,h as y,t as V}from"./index-DsliLC_t.js";const Q=G({__name:"doris-property",props:{nodeData:Object,lf:Object||String,flowDetail:{type:Object,default:()=>({})},type:{type:String}},setup(m,{expose:q,emit:O}){const i=m,k=O;let t=H({name:"Doris数据写入",description:"",datasourceCode:null,datasourceName:null,schemaCode:null,schemaName:null,tableCode:null,tableName:null});const j={name:[{required:!0,message:"名称必填"}],datasourceCode:[{required:!0,message:"数据源必选"}],schemaCode:[{required:!0,message:"数据库必选"}],tableCode:[{required:!0,message:"表必选"}]},B=()=>{i.lf.setProperties(i.nodeData.id,{...t})},L=n=>{n.validateResult===!0&&(B(),k("closed"))},g=b(null);function R(){g.value.submit()}const N=()=>{k("closed")},D=b([]),S=b([]),w=b([]);function x(n){t.datasourceName=n.name,z({id:n.id}).then(a=>{a&&(S.value=a,a.forEach(s=>{if(i.nodeData.properties.schemaCode===s.key){F(s);return}}))})}function F(n){t.schemaName=n.label,w.value=n.children}async function $(){await A({query:{type:"Doris",status:"ENABLE"},page:{current:1,size:9999},orders:[]}).then(n=>{const{records:a}=n;D.value=a,a.forEach(s=>{if(i.nodeData.properties.datasourceCode===s.code){x(s);return}})}),Object.assign(t,i.nodeData.properties)}return I(()=>{$()}),q({cancelFunc:N,clickFormSubmit:R}),(n,a)=>{const s=d("t-input"),c=d("t-form-item"),C=d("t-option"),v=d("t-select"),M=d("t-divider"),P=d("t-textarea"),T=d("t-form");return u(),f("div",null,[r(T,{ref_key:"form",ref:g,rules:j,data:l(t),colon:!0,onReset:N,onSubmit:L},{default:o(()=>[r(c,{label:"名称",name:"name"},{default:o(()=>[r(s,{modelValue:l(t).name,"onUpdate:modelValue":a[0]||(a[0]=e=>l(t).name=e),readonly:m.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1}),r(c,{label:"数据源",name:"datasourceCode"},{default:o(()=>[r(v,{filterable:"",modelValue:l(t).datasourceCode,"onUpdate:modelValue":a[1]||(a[1]=e=>l(t).datasourceCode=e),onChange:a[2]||(a[2]=()=>{l(t).schemaCode=null,l(t).schemaName=null,l(t).tableCode=null,l(t).tableName=null}),readonly:m.type==="publish",placeholder:"请选择数据源",style:{width:"100%"}},{default:o(()=>[(u(!0),f(h,null,_(D.value,e=>(u(),p(C,{value:e.code,onClick:E=>x(e),label:e.name},{default:o(()=>[y(V(e.name),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["modelValue","readonly"])]),_:1}),l(t).datasourceCode?(u(),p(c,{key:0,label:"库",name:"schemaCode"},{default:o(()=>[r(v,{modelValue:l(t).schemaCode,"onUpdate:modelValue":a[3]||(a[3]=e=>l(t).schemaCode=e),readonly:m.type==="publish",placeholder:"请选择数据库",style:{width:"100%"}},{default:o(()=>[(u(!0),f(h,null,_(S.value,e=>(u(),p(C,{value:e.key,onClick:E=>F(e),label:e.label},{default:o(()=>[y(V(e.label),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["modelValue","readonly"])]),_:1})):U("",!0),l(t).schemaCode?(u(),p(c,{key:1,label:"表",name:"tableCode"},{default:o(()=>[r(v,{modelValue:l(t).tableCode,"onUpdate:modelValue":a[4]||(a[4]=e=>l(t).tableCode=e),readonly:m.type==="publish",placeholder:"请选择写入的表",style:{width:"100%"}},{default:o(()=>[(u(!0),f(h,null,_(w.value,e=>(u(),p(C,{value:e.key,onClick:E=>l(t).tableName=e.label,label:e.label},{default:o(()=>[y(V(e.label),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["modelValue","readonly"])]),_:1})):U("",!0),r(M,null,{default:o(()=>[...a[6]||(a[6]=[y("其他配置",-1)])]),_:1}),r(c,{label:"描述",prop:"description"},{default:o(()=>[r(P,{modelValue:l(t).description,"onUpdate:modelValue":a[5]||(a[5]=e=>l(t).description=e),readonly:m.type==="publish",rows:4},null,8,["modelValue","readonly"])]),_:1})]),_:1},8,["data"])])}}});export{Q as _};

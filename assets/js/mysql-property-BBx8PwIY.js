import{e as j}from"./toggleHighContrast-BzokclBc.js";import{g as R}from"./source-C6q21X3i.js";import{d as P,db as Q,r as c,L as z,N as T,v as $,a as u,c as v,o as f,b as l,u as a,w as n,x as A,F as I,y as W,f as G,h as i,t as H,e as J,i as K}from"./index-DsliLC_t.js";const X={key:0},Y=P({__name:"mysql-property",props:{nodeData:Object,lf:Object||String,flowDetail:{type:Object,default:()=>({})},type:{type:String}},setup(s,{expose:L,emit:k}){const y=s,g=k;let t=Q({name:"MySQL数据查询",description:"",queryType:"1",limit:null,selectText:"",datasourceCode:void 0,datasourceName:void 0,scrollColumn:void 0});const w={name:[{required:!0,message:"名称必填"}],queryType:[{required:!0,message:"查询类型必填"}],datasourceCode:[{required:!0,message:"数据源必填"}],selectText:[{required:!0,message:"查询语句必填"}],scrollColumn:[{required:!0,message:"滚动的列必填"}]},b=c(null);let r;const N=c("");z(()=>{b.value?(h(),r.updateOptions({theme:T()})):r&&r.dispose()});function h(){r||(r=j.create(b.value,{value:N.value,placeholder:"select * from table",language:"sql",theme:T(),codeLens:!1,folding:!0,snippetSuggestions:"inline",tabCompletion:"on",foldingStrategy:"auto",smoothScrolling:!0,minimap:{enabled:!1},scrollbar:{verticalScrollbarSize:4},automaticLayout:!0}),r.onDidChangeModelContent(()=>{t.selectText=r.getValue()}))}const F=()=>{y.lf.setProperties(y.nodeData.id,{...t})},M=m=>{m.validateResult===!0&&(F(),g("closed"))},V=c(null);function U(){V.value.submit()}const _=()=>{g("closed")},C=c([]);async function D(){await R({query:{type:"MySQL",status:"ENABLE"},page:{current:1,size:9999},orders:[]}).then(m=>{const{records:e}=m;C.value=e}),Object.assign(t,y.nodeData.properties),r.setValue(t.selectText)}return $(()=>{D()}),L({cancelFunc:_,clickFormSubmit:U}),(m,e)=>{const q=u("t-input"),d=u("t-form-item"),p=u("t-option"),x=u("t-select"),S=u("t-divider"),E=u("t-input-number"),O=u("t-textarea"),B=u("t-form");return f(),v("div",null,[l(B,{ref_key:"form",ref:V,rules:w,data:a(t),colon:!0,onReset:_,onSubmit:M},{default:n(()=>[l(d,{label:"名称",name:"name"},{default:n(()=>[l(q,{modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=o=>a(t).name=o),readonly:s.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1}),l(d,{label:"数据源",name:"datasourceCode"},{default:n(()=>[l(x,{readonly:s.type==="publish",filterable:"",modelValue:a(t).datasourceCode,"onUpdate:modelValue":e[1]||(e[1]=o=>a(t).datasourceCode=o),placeholder:"请选择数据源",style:{width:"100%"}},{default:n(()=>[(f(!0),v(I,null,W(C.value,o=>(f(),G(p,{value:o.code,onClick:Z=>a(t).datasourceName=o.name,label:o.name},{default:n(()=>[i(H(o.name),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["readonly","modelValue"])]),_:1}),l(S,null,{default:n(()=>[...e[6]||(e[6]=[i("查询语句",-1)])]),_:1}),l(d,{name:"selectText",labelWidth:0},{default:n(()=>[J("div",{ref_key:"editorContainer",ref:b,style:{height:"250px",width:"100%"}},null,512)]),_:1}),l(d,{label:"查询方式",name:"queryType"},{default:n(()=>[l(x,{modelValue:a(t).queryType,"onUpdate:modelValue":e[2]||(e[2]=o=>a(t).queryType=o),readonly:s.type==="publish",placeholder:"请选择查询方式",style:{width:"100%"}},{default:n(()=>[l(p,{value:"1",label:"流式查询"},{default:n(()=>[...e[7]||(e[7]=[i("流式查询",-1)])]),_:1}),l(p,{value:"2",label:"分页查询"},{default:n(()=>[...e[8]||(e[8]=[i("分页查询",-1)])]),_:1}),l(p,{value:"3",label:"滚动查询"},{default:n(()=>[...e[9]||(e[9]=[i("滚动查询",-1)])]),_:1})]),_:1},8,["modelValue","readonly"])]),_:1}),l(d,{label:a(t).queryType==="2"?"每页数量":"每次数量",name:"limit"},{default:n(()=>[l(E,{readonly:s.type==="publish",placeholder:"自动",modelValue:a(t).limit,"onUpdate:modelValue":e[3]||(e[3]=o=>a(t).limit=o),min:1,max:1e5},null,8,["readonly","modelValue"])]),_:1},8,["label"]),a(t).queryType=="3"?(f(),v("div",X,[l(d,{label:"滚动的列",name:"scrollColumn"},{default:n(()=>[l(q,{modelValue:a(t).scrollColumn,"onUpdate:modelValue":e[4]||(e[4]=o=>a(t).scrollColumn=o),readonly:s.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1})])):A("",!0),l(S,null,{default:n(()=>[...e[10]||(e[10]=[i("其他配置",-1)])]),_:1}),l(d,{label:"描述",prop:"description"},{default:n(()=>[l(O,{modelValue:a(t).description,"onUpdate:modelValue":e[5]||(e[5]=o=>a(t).description=o),readonly:s.type==="publish",rows:4},null,8,["modelValue","readonly"])]),_:1})]),_:1},8,["data"])])}}}),oe=K(Y,[["__scopeId","data-v-662f7f67"]]);export{oe as default};

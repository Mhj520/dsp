import{g as I}from"./source-C6q21X3i.js";import{d as _,db as j,r as h,v as T,a as r,c as q,o as i,b as l,u as o,w as n,f,x as S,F as K,y as M,h as m,t as P}from"./index-DsliLC_t.js";const H=_({__name:"kafka-property",props:{nodeData:Object,lf:Object||String,flowDetail:{type:Object,default:()=>({})},type:{type:String}},setup(u,{expose:L,emit:N}){const b=u,v=N;let t=j({name:"Kafka消息接收",description:"",datasourceCode:null,status:"ENABLE",topic:null,key:null,group:null,idempotent:!1,idempotentDuration:3600,idempotentScope:"CURRENT",datasourceName:null,batch:!1,batchSize:100});const w={name:[{required:!0,message:"名称必填"}],datasourceCode:[{required:!0,message:"数据源必填"}],topic:[{required:!0}],status:[{required:!0}],idempotent:[{required:!0}],idempotentDuration:[{required:!0}],idempotentScope:[{required:!0}],batch:[{required:!0}],batchSize:[{required:!0}]},F=()=>{b.lf.setProperties(b.nodeData.id,{...t})},R=s=>{s.validateResult===!0&&(F(),v("closed"))},U=h(null);function z(){U.value.submit()}const D=()=>{v("closed")},C=h([]);async function B(){await I({query:{type:"Kafka",status:"ENABLE"},page:{current:1,size:9999},orders:[]}).then(s=>{const{records:e}=s;C.value=e}),Object.assign(t,b.nodeData.properties)}return T(()=>{B()}),L({cancelFunc:D,clickFormSubmit:z}),(s,e)=>{const p=r("t-input"),d=r("t-form-item"),c=r("t-option"),x=r("t-select"),y=r("t-switch"),V=r("t-divider"),g=r("t-icon"),k=r("t-popup"),E=r("t-input-number"),O=r("t-textarea"),A=r("t-form");return i(),q("div",null,[l(A,{ref_key:"form",ref:U,rules:w,data:o(t),colon:!0,onReset:D,onSubmit:R},{default:n(()=>[l(d,{label:"名称",name:"name"},{default:n(()=>[l(p,{modelValue:o(t).name,"onUpdate:modelValue":e[0]||(e[0]=a=>o(t).name=a),placeholder:"请输入内容",readonly:u.type==="publish"},null,8,["modelValue","readonly"])]),_:1}),l(d,{label:"数据源",name:"datasourceCode"},{default:n(()=>[l(x,{readonly:u.type==="publish",filterable:"",modelValue:o(t).datasourceCode,"onUpdate:modelValue":e[1]||(e[1]=a=>o(t).datasourceCode=a),placeholder:"请选择数据源",style:{width:"100%"}},{default:n(()=>[(i(!0),q(K,null,M(C.value,a=>(i(),f(c,{value:a.code,onClick:$=>o(t).datasourceName=a.name,label:a.name},{default:n(()=>[m(P(a.name),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["readonly","modelValue"])]),_:1}),l(d,{label:"主题",name:"topic"},{default:n(()=>[l(p,{modelValue:o(t).topic,"onUpdate:modelValue":e[2]||(e[2]=a=>o(t).topic=a),readonly:u.type==="publish",placeholder:"请输入主题"},null,8,["modelValue","readonly"])]),_:1}),l(d,{label:"消费组",name:"group"},{default:n(()=>[l(p,{modelValue:o(t).group,"onUpdate:modelValue":e[3]||(e[3]=a=>o(t).group=a),readonly:u.type==="publish",placeholder:"工作空间编码-流程编码-组件编码"},null,8,["modelValue","readonly"])]),_:1}),l(d,{label:"键",name:"key"},{default:n(()=>[l(p,{modelValue:o(t).key,"onUpdate:modelValue":e[4]||(e[4]=a=>o(t).key=a),readonly:u.type==="publish",placeholder:"请输入"},null,8,["modelValue","readonly"])]),_:1}),l(d,{label:"状态",name:"status"},{default:n(()=>[l(y,{modelValue:o(t).status,"onUpdate:modelValue":e[5]||(e[5]=a=>o(t).status=a),customValue:["ENABLE","DISABLE"],"before-change":()=>u.type!=="publish"},null,8,["modelValue","before-change"])]),_:1}),l(V,null,{default:n(()=>[...e[12]||(e[12]=[m("幂等",-1)])]),_:1}),l(d,{label:"幂等",name:"idempotent"},{default:n(()=>[l(y,{modelValue:o(t).idempotent,"onUpdate:modelValue":e[6]||(e[6]=a=>o(t).idempotent=a),"before-change":()=>u.type!=="publish"},null,8,["modelValue","before-change"]),e[13]||(e[13]=m("   ",-1)),l(k,{content:"发送方必须在请求头指定messageId，否则无效，开启后吞吐量会下降"},{default:n(()=>[l(g,{loadDefaultIcons:!1,name:"help-circle"})]),_:1})]),_:1}),o(t).idempotent?(i(),f(d,{key:0,label:"持有时间(分)",name:"idempotentDuration"},{default:n(()=>[l(E,{modelValue:o(t).idempotentDuration,"onUpdate:modelValue":e[7]||(e[7]=a=>o(t).idempotentDuration=a),min:1,max:1e5,readonly:u.type==="publish",placeholder:"请输入"},null,8,["modelValue","readonly"]),e[14]||(e[14]=m("   ",-1)),l(k,{content:"当此时间过后，允许被二次消费"},{default:n(()=>[l(g,{loadDefaultIcons:!1,name:"help-circle"})]),_:1})]),_:1})):S("",!0),o(t).idempotent?(i(),f(d,{key:1,label:"作用域",name:"idempotentScope"},{default:n(()=>[l(x,{modelValue:o(t).idempotentScope,"onUpdate:modelValue":e[8]||(e[8]=a=>o(t).idempotentScope=a),style:{width:"322px"},class:"demo-select-base",placeholder:"请选择",clearable:"",readonly:u.type==="publish"},{default:n(()=>[l(c,{value:"CURRENT",label:"当前流程"},{default:n(()=>[...e[15]||(e[15]=[m("当前流程",-1)])]),_:1}),l(c,{value:"ALL_FLOW",label:"所有流程"},{default:n(()=>[...e[16]||(e[16]=[m("所有流程",-1)])]),_:1})]),_:1},8,["modelValue","readonly"])]),_:1})):S("",!0),l(V,null,{default:n(()=>[...e[17]||(e[17]=[m("批量消费",-1)])]),_:1}),l(d,{label:"批量消费",name:"batch"},{default:n(()=>[l(y,{modelValue:o(t).batch,"onUpdate:modelValue":e[9]||(e[9]=a=>o(t).batch=a),"before-change":()=>u.type!=="publish"},null,8,["modelValue","before-change"]),e[18]||(e[18]=m("   ",-1)),l(k,{content:`消费指定数量时触发一次下游节点，发送下游总记录数量为：消费数量${o(t).batch?"("+o(t).batchSize+")":""} * 每次消费记录数量`},{default:n(()=>[l(g,{loadDefaultIcons:!1,name:"help-circle"})]),_:1},8,["content"])]),_:1}),o(t).batch?(i(),f(d,{key:2,label:"每次数量",name:"batchSize"},{default:n(()=>[l(E,{modelValue:o(t).batchSize,"onUpdate:modelValue":e[10]||(e[10]=a=>o(t).batchSize=a),min:1,max:2e4,readonly:u.type==="publish",placeholder:"请输入"},null,8,["modelValue","readonly"])]),_:1})):S("",!0),l(V,null,{default:n(()=>[...e[19]||(e[19]=[m("其他配置",-1)])]),_:1}),l(d,{label:"描述",prop:"description"},{default:n(()=>[l(O,{modelValue:o(t).description,"onUpdate:modelValue":e[11]||(e[11]=a=>o(t).description=a),readonly:u.type==="publish",rows:4},null,8,["modelValue","readonly"])]),_:1})]),_:1},8,["data"])])}}});export{H as _};

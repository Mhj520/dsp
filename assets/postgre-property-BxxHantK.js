import{e as B}from"./toggleHighContrast-BzokclBc.js";import{g as j}from"./source-C6q21X3i.js";import{d as M,db as R,r as b,L as z,N as S,v as Q,a as u,c as V,o as c,b as l,u as a,w as n,x as $,F as A,y as I,f as W,h as i,t as G,e as H,i as J}from"./index-DsliLC_t.js";const K={key:0},X=M({__name:"postgre-property",props:{nodeData:Object,lf:Object||String,flowDetail:{type:Object,default:()=>({})},type:{type:String}},setup(s,{expose:k,emit:w}){const f=s,g=w;let t=R({name:"PostgreSQL数据查询",description:"",queryType:"1",limit:null,selectText:"",datasourceCode:"",datasourceName:"",scrollColumn:""});const L={name:[{required:!0,message:"名称必填"}],queryType:[{required:!0,message:"查询类型必填"}],datasourceCode:[{required:!0,message:"数据源必填"}],selectText:[{required:!0,message:"查询语句必填"}],scrollColumn:[{required:!0,message:"滚动的列必填"}]},y=b(null);let r;z(()=>{y.value?(N(),r.updateOptions({theme:S()})):r&&r.dispose()});function N(){r||(r=B.create(y.value,{value:t.selectText,placeholder:"select * from table",language:"sql",theme:S(),minimap:{enabled:!1},scrollbar:{verticalScrollbarSize:4},automaticLayout:!0}),r.onDidChangeModelContent(()=>{t.selectText=r.getValue()}))}const F=()=>{f.lf.setProperties(f.nodeData.id,{...t})},U=m=>{m.validateResult===!0&&(F(),g("closed"))},v=b(null);function h(){v.value.submit()}const _=()=>{g("closed")},C=b([]);async function D(){await j({query:{type:"PostgreSQL",status:"ENABLE"},page:{current:1,size:9999},orders:[]}).then(m=>{C.value=m.records}),Object.assign(t,f.nodeData.properties),r&&r.setValue(t.selectText)}return Q(()=>{D()}),k({cancelFunc:_,clickFormSubmit:h}),(m,e)=>{const x=u("t-input"),d=u("t-form-item"),p=u("t-option"),q=u("t-select"),T=u("t-divider"),E=u("t-input-number"),O=u("t-textarea"),P=u("t-form");return c(),V("div",null,[l(P,{ref_key:"form",ref:v,rules:L,data:a(t),colon:!0,onReset:_,onSubmit:U},{default:n(()=>[l(d,{label:"名称",name:"name"},{default:n(()=>[l(x,{modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=o=>a(t).name=o),readonly:s.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1}),l(d,{label:"数据源",name:"datasourceCode"},{default:n(()=>[l(q,{readonly:s.type==="publish",filterable:"",modelValue:a(t).datasourceCode,"onUpdate:modelValue":e[1]||(e[1]=o=>a(t).datasourceCode=o),placeholder:"请选择数据源",style:{width:"100%"}},{default:n(()=>[(c(!0),V(A,null,I(C.value,o=>(c(),W(p,{value:o.code,onClick:Y=>a(t).datasourceName=o.name,label:o.name},{default:n(()=>[i(G(o.name),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["readonly","modelValue"])]),_:1}),l(T,null,{default:n(()=>[...e[6]||(e[6]=[i("查询语句",-1)])]),_:1}),l(d,{name:"selectText",labelWidth:0},{default:n(()=>[H("div",{ref_key:"editorContainer",ref:y,style:{height:"250px",width:"100%"}},null,512)]),_:1}),l(d,{label:"查询方式",name:"queryType"},{default:n(()=>[l(q,{modelValue:a(t).queryType,"onUpdate:modelValue":e[2]||(e[2]=o=>a(t).queryType=o),readonly:s.type==="publish",placeholder:"请选择查询方式",style:{width:"100%"}},{default:n(()=>[l(p,{value:"1",label:"流式查询"},{default:n(()=>[...e[7]||(e[7]=[i("流式查询",-1)])]),_:1}),l(p,{value:"2",label:"分页查询"},{default:n(()=>[...e[8]||(e[8]=[i("分页查询",-1)])]),_:1}),l(p,{value:"3",label:"滚动查询"},{default:n(()=>[...e[9]||(e[9]=[i("滚动查询",-1)])]),_:1})]),_:1},8,["modelValue","readonly"])]),_:1}),l(d,{label:a(t).queryType==="2"?"每页数量":"每次数量",name:"limit"},{default:n(()=>[l(E,{readonly:s.type==="publish",placeholder:"自动",modelValue:a(t).limit,"onUpdate:modelValue":e[3]||(e[3]=o=>a(t).limit=o),min:1,max:1e5},null,8,["readonly","modelValue"])]),_:1},8,["label"]),a(t).queryType=="3"?(c(),V("div",K,[l(d,{label:"滚动的列",name:"scrollColumn"},{default:n(()=>[l(x,{modelValue:a(t).scrollColumn,"onUpdate:modelValue":e[4]||(e[4]=o=>a(t).scrollColumn=o),readonly:s.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1})])):$("",!0),l(T,null,{default:n(()=>[...e[10]||(e[10]=[i("其他配置",-1)])]),_:1}),l(d,{label:"描述",prop:"description"},{default:n(()=>[l(O,{modelValue:a(t).description,"onUpdate:modelValue":e[5]||(e[5]=o=>a(t).description=o),readonly:s.type==="publish",rows:4},null,8,["modelValue","readonly"])]),_:1})]),_:1},8,["data"])])}}}),le=J(X,[["__scopeId","data-v-8634252a"]]);export{le as default};

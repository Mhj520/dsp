import{g as O}from"./source-C6q21X3i.js";import{d as A,db as I,r as x,v as j,a as r,c as k,o as m,b as l,u as o,w as n,f as s,x as b,F as M,y as P,h as i,t as $}from"./index-DsliLC_t.js";const H=A({__name:"rabbit-property",props:{nodeData:Object,lf:Object||String,flowDetail:{type:Object,default:()=>({})},type:{type:String}},setup(u,{expose:E,emit:L}){const c=u,h=L;let t=I({name:"Rabbit消息接收",description:"",datasourceCode:null,status:"ENABLE",queue:null,idempotent:!1,idempotentDuration:3600,idempotentScope:"CURRENT",datasourceName:null,batch:!1,batchSize:100,batchReceiveTimeout:5e3});const N={name:[{required:!0,message:"名称必填"}],datasourceCode:[{required:!0,message:"数据源必填"}],queue:[{required:!0}],status:[{required:!0}],idempotent:[{required:!0}],idempotentDuration:[{required:!0}],idempotentScope:[{required:!0}],batch:[{required:!0}],batchSize:[{required:!0}],batchReceiveTimeout:[{required:!0}]},w=()=>{c.lf.setProperties(c.nodeData.id,{...t})},F=p=>{p.validateResult===!0&&(w(),h("closed"))},q=x(null);function T(){q.value.submit()}const R=()=>{h("closed")},D=x([]);async function _(){await O({query:{type:"RabbitMQ",status:"ENABLE"},page:{current:1,size:9999},orders:[]}).then(p=>{const{records:e}=p;D.value=e}),Object.assign(t,c.nodeData.properties)}return j(()=>{_()}),E({cancelFunc:R,clickFormSubmit:T}),(p,e)=>{const U=r("t-input"),d=r("t-form-item"),f=r("t-option"),C=r("t-select"),y=r("t-switch"),V=r("t-divider"),v=r("t-icon"),S=r("t-popup"),g=r("t-input-number"),z=r("t-textarea"),B=r("t-form");return m(),k("div",null,[l(B,{ref_key:"form",ref:q,rules:N,data:o(t),colon:!0,onReset:R,onSubmit:F},{default:n(()=>[l(d,{label:"名称",name:"name"},{default:n(()=>[l(U,{modelValue:o(t).name,"onUpdate:modelValue":e[0]||(e[0]=a=>o(t).name=a),readonly:u.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1}),l(d,{label:"数据源",name:"datasourceCode"},{default:n(()=>[l(C,{readonly:u.type==="publish",filterable:"",modelValue:o(t).datasourceCode,"onUpdate:modelValue":e[1]||(e[1]=a=>o(t).datasourceCode=a),placeholder:"请选择数据源",style:{width:"100%"}},{default:n(()=>[(m(!0),k(M,null,P(D.value,a=>(m(),s(f,{value:a.code,onClick:Q=>o(t).datasourceName=a.name,label:a.name},{default:n(()=>[i($(a.name),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["readonly","modelValue"])]),_:1}),l(d,{label:"队列",name:"queue"},{default:n(()=>[l(U,{modelValue:o(t).queue,"onUpdate:modelValue":e[2]||(e[2]=a=>o(t).queue=a),readonly:u.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1}),l(d,{label:"状态",name:"status"},{default:n(()=>[l(y,{modelValue:o(t).status,"onUpdate:modelValue":e[3]||(e[3]=a=>o(t).status=a),customValue:["ENABLE","DISABLE"],"before-change":()=>u.type!=="publish"},null,8,["modelValue","before-change"])]),_:1}),l(V,null,{default:n(()=>[...e[11]||(e[11]=[i("幂等",-1)])]),_:1}),l(d,{label:"开启",name:"idempotent"},{default:n(()=>[l(y,{modelValue:o(t).idempotent,"onUpdate:modelValue":e[4]||(e[4]=a=>o(t).idempotent=a),"before-change":()=>u.type!=="publish"},null,8,["modelValue","before-change"]),e[12]||(e[12]=i("   ",-1)),l(S,{content:"发送方必须指定messageId，否则无效，开启后吞吐量会下降"},{default:n(()=>[l(v,{loadDefaultIcons:!1,name:"help-circle"})]),_:1})]),_:1}),o(t).idempotent?(m(),s(d,{key:0,label:"持有时间(分)",name:"idempotentDuration"},{default:n(()=>[l(g,{modelValue:o(t).idempotentDuration,"onUpdate:modelValue":e[5]||(e[5]=a=>o(t).idempotentDuration=a),min:1,max:1e5,readonly:u.type==="publish",placeholder:"请输入"},null,8,["modelValue","readonly"]),e[13]||(e[13]=i("   ",-1)),l(S,{content:"当此时间过后，允许被二次消费"},{default:n(()=>[l(v,{loadDefaultIcons:!1,name:"help-circle"})]),_:1})]),_:1})):b("",!0),o(t).idempotent?(m(),s(d,{key:1,label:"作用域",name:"idempotentScope"},{default:n(()=>[l(C,{readonly:u.type==="publish",modelValue:o(t).idempotentScope,"onUpdate:modelValue":e[6]||(e[6]=a=>o(t).idempotentScope=a),style:{width:"322px"},class:"demo-select-base",placeholder:"请选择",clearable:""},{default:n(()=>[l(f,{value:"CURRENT",label:"当前流程"},{default:n(()=>[...e[14]||(e[14]=[i("当前流程",-1)])]),_:1}),l(f,{value:"ALL_FLOW",label:"所有流程"},{default:n(()=>[...e[15]||(e[15]=[i("所有流程",-1)])]),_:1})]),_:1},8,["readonly","modelValue"])]),_:1})):b("",!0),l(V,null,{default:n(()=>[...e[16]||(e[16]=[i("批量消费",-1)])]),_:1}),l(d,{label:"批量消费",name:"batch"},{default:n(()=>[l(y,{modelValue:o(t).batch,"onUpdate:modelValue":e[7]||(e[7]=a=>o(t).batch=a),"before-change":()=>u.type!=="publish"},null,8,["modelValue","before-change"]),e[17]||(e[17]=i("   ",-1)),l(S,{content:`消费指定数量时触发一次下游节点，发送下游总记录数量为：消费数量${o(t).batch?"("+o(t).batchSize+")":""} * 每次消费记录数量`},{default:n(()=>[l(v,{loadDefaultIcons:!1,name:"help-circle"})]),_:1},8,["content"])]),_:1}),o(t).batch?(m(),s(d,{key:2,label:"每次数量",name:"batchSize"},{default:n(()=>[l(g,{modelValue:o(t).batchSize,"onUpdate:modelValue":e[8]||(e[8]=a=>o(t).batchSize=a),min:1,max:2e4,readonly:u.type==="publish",placeholder:"请输入"},null,8,["modelValue","readonly"])]),_:1})):b("",!0),o(t).batch?(m(),s(d,{key:3,label:"超时时间",name:"batchReceiveTimeout"},{default:n(()=>[l(g,{modelValue:o(t).batchReceiveTimeout,"onUpdate:modelValue":e[9]||(e[9]=a=>o(t).batchReceiveTimeout=a),min:1,max:1e5,readonly:u.type==="publish",placeholder:"请输入"},null,8,["modelValue","readonly"])]),_:1})):b("",!0),l(V,null,{default:n(()=>[...e[18]||(e[18]=[i("其他配置",-1)])]),_:1}),l(d,{label:"描述",prop:"description"},{default:n(()=>[l(z,{modelValue:o(t).description,"onUpdate:modelValue":e[10]||(e[10]=a=>o(t).description=a),readonly:u.type==="publish",rows:4},null,8,["modelValue","readonly"])]),_:1})]),_:1},8,["data"])])}}});export{H as _};

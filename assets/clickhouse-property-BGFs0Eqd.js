import{e as M}from"./toggleHighContrast-BzokclBc.js";import{g as R}from"./source-C6q21X3i.js";import{d as H,db as P,r as f,L as z,N as k,v as $,a as u,c as g,o as y,b as l,u as a,w as n,x as A,F as I,y as W,f as G,h as i,t as J,e as K,i as Q}from"./index-DsliLC_t.js";const X={key:0},Y=H({__name:"clickhouse-property",props:{nodeData:Object,lf:Object||String,flowDetail:{type:Object,default:()=>({})},type:{type:String}},setup(s,{expose:S,emit:w}){const b=s,v=w;let t=P({name:"ClickHouse数据查询",description:"",queryType:"1",limit:null,selectText:"",scrollColumn:null,datasourceCode:null,datasourceName:null});const h={name:[{required:!0,message:"名称必填"}],queryType:[{required:!0,message:"查询类型必填"}],datasourceCode:[{required:!0,message:"数据源必填"}],selectText:[{required:!0,message:"查询语句必填"}],scrollColumn:[{required:!0,message:"滚动的列必填"}]},m=f(null);let r;const E=f("");z(()=>{m.value?(console.log("Element is present!",m.value),N(),r.updateOptions({theme:k()})):(console.log("Element is not present!",r),r&&r.dispose())});function N(){r||(r=M.create(m.value,{value:E.value,placeholder:"select * from table",language:"sql",theme:k(),codeLens:!1,folding:!0,snippetSuggestions:"inline",tabCompletion:"on",foldingStrategy:"auto",smoothScrolling:!0,minimap:{enabled:!1},scrollbar:{verticalScrollbarSize:4},automaticLayout:!0}),r.onDidChangeModelContent(()=>{t.selectText=r.getValue()}))}const F=()=>{b.lf.setProperties(b.nodeData.id,{...t})},L=p=>{p.validateResult===!0&&(F(),v("closed"))},C=f(null);function U(){C.value.submit()}const V=()=>{v("closed")},_=f([]);async function D(){await R({query:{type:"ClickHouse",status:"ENABLE"},page:{current:1,size:9999},orders:[]}).then(p=>{const{records:e}=p;_.value=e}),Object.assign(t,b.nodeData.properties),r.setValue(t.selectText)}return $(()=>{D()}),S({cancelFunc:V,clickFormSubmit:U}),(p,e)=>{const x=u("t-input"),d=u("t-form-item"),c=u("t-option"),q=u("t-select"),T=u("t-divider"),O=u("t-input-number"),B=u("t-textarea"),j=u("t-form");return y(),g("div",null,[l(j,{ref_key:"form",ref:C,rules:h,data:a(t),colon:!0,onReset:V,onSubmit:L},{default:n(()=>[l(d,{label:"名称",name:"name"},{default:n(()=>[l(x,{modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=o=>a(t).name=o),readonly:s.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1}),l(d,{label:"数据源",name:"datasourceCode"},{default:n(()=>[l(q,{modelValue:a(t).datasourceCode,"onUpdate:modelValue":e[1]||(e[1]=o=>a(t).datasourceCode=o),readonly:s.type==="publish",filterable:"",placeholder:"请选择数据源",style:{width:"100%"}},{default:n(()=>[(y(!0),g(I,null,W(_.value,o=>(y(),G(c,{value:o.code,onClick:Z=>a(t).datasourceName=o.name,label:o.name},{default:n(()=>[i(J(o.name),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["modelValue","readonly"])]),_:1}),l(T,null,{default:n(()=>[...e[6]||(e[6]=[i("查询语句",-1)])]),_:1}),l(d,{name:"selectText",labelWidth:0},{default:n(()=>[K("div",{ref_key:"editorContainer",ref:m,style:{height:"250px",width:"100%"}},null,512)]),_:1}),l(d,{label:"查询方式",name:"queryType"},{default:n(()=>[l(q,{modelValue:a(t).queryType,"onUpdate:modelValue":e[2]||(e[2]=o=>a(t).queryType=o),readonly:s.type==="publish",placeholder:"请选择查询方式",style:{width:"100%"}},{default:n(()=>[l(c,{value:"1",label:"流式查询"},{default:n(()=>[...e[7]||(e[7]=[i("流式查询",-1)])]),_:1}),l(c,{value:"2",label:"分页查询"},{default:n(()=>[...e[8]||(e[8]=[i("分页查询",-1)])]),_:1}),l(c,{value:"3",label:"滚动查询"},{default:n(()=>[...e[9]||(e[9]=[i("滚动查询",-1)])]),_:1})]),_:1},8,["modelValue","readonly"])]),_:1}),l(d,{label:a(t).queryType==="2"?"每页数量":"每次数量",name:"limit"},{default:n(()=>[l(O,{modelValue:a(t).limit,"onUpdate:modelValue":e[3]||(e[3]=o=>a(t).limit=o),readonly:s.type==="publish",placeholder:"自动",min:1,max:1e5},null,8,["modelValue","readonly"])]),_:1},8,["label"]),a(t).queryType=="3"?(y(),g("div",X,[l(d,{label:"滚动的列",name:"scrollColumn"},{default:n(()=>[l(x,{modelValue:a(t).scrollColumn,"onUpdate:modelValue":e[4]||(e[4]=o=>a(t).scrollColumn=o),readonly:s.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1})])):A("",!0),l(T,null,{default:n(()=>[...e[10]||(e[10]=[i("其他配置",-1)])]),_:1}),l(d,{label:"描述",prop:"description"},{default:n(()=>[l(B,{modelValue:a(t).description,"onUpdate:modelValue":e[5]||(e[5]=o=>a(t).description=o),readonly:s.type==="publish",rows:4},null,8,["modelValue","readonly"])]),_:1})]),_:1},8,["data"])])}}}),oe=Q(Y,[["__scopeId","data-v-ccd1b7d8"]]);export{oe as default};

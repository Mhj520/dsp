import{l as z,g as A}from"./source-C6q21X3i.js";import{d as G,db as H,r as b,v as I,a as d,c as f,o as s,b as r,u as l,w as o,f as p,x as R,F as h,y as _,h as y,t as k}from"./index-DsliLC_t.js";const Q=G({__name:"starrocks-property",props:{nodeData:Object,lf:Object||String,flowDetail:{type:Object,default:()=>({})},type:{type:String}},setup(m,{expose:U,emit:q}){const c=m,V=q;let t=H({name:"StarRocks数据写入",description:"",datasourceCode:null,datasourceName:null,schemaName:null,schemaCode:null,tableCode:null,tableName:null});const O={name:[{required:!0,message:"名称必填"}],datasourceCode:[{required:!0,message:"数据源必选"}],schemaCode:[{required:!0,message:"数据库必选"}],tableCode:[{required:!0,message:"表必选"}]},j=()=>{c.lf.setProperties(c.nodeData.id,{...t})},B=n=>{n.validateResult===!0&&(j(),V("closed"))},g=b(null);function L(){g.value.submit()}const N=()=>{V("closed")},S=b([]),w=b([]),x=b([]);function D(n){t.datasourceName=n.name,z({id:n.id}).then(a=>{a&&(w.value=a,a.forEach(u=>{if(c.nodeData.properties.schemaCode===u.key){F(u);return}}))})}function F(n){t.schemaName=n.label,x.value=n.children}async function $(){await A({query:{type:"StarRocks",status:"ENABLE"},page:{current:1,size:9999},orders:[]}).then(n=>{const{records:a}=n;S.value=a,a.forEach(u=>{if(c.nodeData.properties.datasourceCode===u.code){D(u);return}})}),Object.assign(t,c.nodeData.properties)}return I(()=>{$()}),U({cancelFunc:N,clickFormSubmit:L}),(n,a)=>{const u=d("t-input"),i=d("t-form-item"),C=d("t-option"),v=d("t-select"),M=d("t-divider"),P=d("t-textarea"),T=d("t-form");return s(),f("div",null,[r(T,{ref_key:"form",ref:g,rules:O,data:l(t),colon:!0,onReset:N,onSubmit:B},{default:o(()=>[r(i,{label:"名称",name:"name"},{default:o(()=>[r(u,{modelValue:l(t).name,"onUpdate:modelValue":a[0]||(a[0]=e=>l(t).name=e),readonly:m.type==="publish",placeholder:"请输入内容"},null,8,["modelValue","readonly"])]),_:1}),r(i,{label:"数据源",name:"datasourceCode"},{default:o(()=>[r(v,{modelValue:l(t).datasourceCode,"onUpdate:modelValue":a[1]||(a[1]=e=>l(t).datasourceCode=e),onChange:a[2]||(a[2]=()=>{l(t).schemaCode=null,l(t).schemaName=null,l(t).tableCode=null}),readonly:m.type==="publish",filterable:"",placeholder:"请选择数据源",style:{width:"100%"}},{default:o(()=>[(s(!0),f(h,null,_(S.value,e=>(s(),p(C,{value:e.code,onClick:E=>D(e),label:e.name},{default:o(()=>[y(k(e.name),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["modelValue","readonly"])]),_:1}),l(t).datasourceCode?(s(),p(i,{key:0,label:"库",name:"schemaCode"},{default:o(()=>[r(v,{modelValue:l(t).schemaCode,"onUpdate:modelValue":a[3]||(a[3]=e=>l(t).schemaCode=e),readonly:m.type==="publish",placeholder:"请选择数据库",style:{width:"100%"}},{default:o(()=>[(s(!0),f(h,null,_(w.value,e=>(s(),p(C,{value:e.key,onClick:E=>F(e),label:e.label},{default:o(()=>[y(k(e.label),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["modelValue","readonly"])]),_:1})):R("",!0),l(t).schemaCode?(s(),p(i,{key:1,label:"表",name:"tableCode"},{default:o(()=>[r(v,{modelValue:l(t).tableCode,"onUpdate:modelValue":a[4]||(a[4]=e=>l(t).tableCode=e),readonly:m.type==="publish",placeholder:"请选择写入的表",style:{width:"100%"}},{default:o(()=>[(s(!0),f(h,null,_(x.value,e=>(s(),p(C,{value:e.key,onClick:E=>l(t).tableName=e.label,label:e.label},{default:o(()=>[y(k(e.label),1)]),_:2},1032,["value","onClick","label"]))),256))]),_:1},8,["modelValue","readonly"])]),_:1})):R("",!0),r(M,null,{default:o(()=>[...a[6]||(a[6]=[y("其他配置",-1)])]),_:1}),r(i,{label:"描述",prop:"description"},{default:o(()=>[r(P,{modelValue:l(t).description,"onUpdate:modelValue":a[5]||(a[5]=e=>l(t).description=e),readonly:m.type==="publish",rows:4},null,8,["modelValue","readonly"])]),_:1})]),_:1},8,["data"])])}}});export{Q as _};
